---
layout: post
title:  "Cosmos-SDK Scavenge 05"
author: violetstair
categories: [ CosmosSDK ]
tags: [golang, programming, cosmos-sdk]
image: assets/images/cosmos-sdk.png
description: "COSMOS SDK로 만들어보는 현상금 사냥꾼 게임"
featured: false
hidden: true
---

## Handler

**Message**가 **Keeper**에 도당하려면 **Handler**를 거쳐야 합니다.
이 단계에서 `Message`의 성공을 논리적으로 허용하거나 거부할 수 있습니다
Keeper내에서 상태가 정확히 어떻게 변경되어야 하는지에 대한 논리적 구조가 구현되는 곳 이기도 합니다.
[Model View Controller](https://en.wikipedia.org/wiki/Model%E2%80%93view%E2%80%93controller)(MVC) 아키텍처가 익숙하다면 `Keeper`는 **Model**과 같고 **Handler**는 **Controller**와 유사하다고 이해할 수 있습니다.
[React/Redux](<https://en.wikipedia.org/wiki/React_(web_framework)>) 또는 [Vue/Vuex](https://en.wikipedia.org/wiki/Vue.js) 아키텍쳐서에 보면, `Keeper`는 **Reducer/Store**, the `Handler`는 **Actions** 유사하다고 볼 수 있습니다.

Handler는 `./x/scavenge/handler.go`에 구현되며 boilerplate에 구현된 구조를 따릅니다.
해당 파일에서 `Message` 의 세 가지 types, `MsgCreateScavenge`, `MsgCommitSolution`, `MsgRevealSolution` 각각에 대한 Handler 함수를 생성합니다.

[handler](https://github.com/cosmos/sdk-tutorials/tree/master/scavenge/x/scavenge/handler.go)

### moduleAcct

handler 함수인 `handleMsgCreateScavenge`와 `handleMsgRevealSolution`에서 `moduleAcct`가 사용된것을 볼 수 있습니다.
이 계정은 공개키 쌍에 의해 제어되지는 않지만 실제 모듈이 소유한 계정에 대한 참조 입니다.
scavenge가 해결될 때 까지 scavenger에 첨부된 보상을 보유하는데 사용되며, scavenge를 해결한 계정에게 보상을 지급합니다.

### Events

각 handler의 끝에는 현재의 메시지를 처리하는 동안 발생한 정보를 transaction내에 로그로 남기는 `EventManager`가 있습니다.
이는 transaction의 결과로 발생한 일을 정확히 알고자 하는 클라이언트 측 소프트웨어에 정확합니다.
이러한 이벤트의 유형은 `./x/scavenge/types/events.go`에 사전에 정의할 수 있습니다.

[events](https://github.com/cosmos/sdk-tutorials/tree/master/scavenge/x/scavenge/types/events.go)

이제 상태를 업데이트하는데 필요한 모든 부분(`Message`, `Handler`, `Keeper`)의 개발을 완료 하였습니다.
이제 REST endpoint나 CLI에서 상태를 조회할 수 있는 _query_ 기능을 작성할 차례 입니다.
두 가지 방법 모두 query를 통해 상태를 질의할 수 있으며 이 모듈을 `Querier`라고 합니다.
