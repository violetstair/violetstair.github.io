---
layout: post
title:  "Cosmos-SDK Scavenge 10"
author: violetstair
categories: [ Cosmos-SDK-Scavenge ]
tags: [golang, programming, cosmos-sdk]
image: assets/images/cosmos-sdk.png
description: "COSMOS SDK로 만들어보는 현상금 사냥꾼 게임"
featured: false
hidden: false
---

## Run

모듈을 구성하고 앱이 이를 사용하도록 구성 되었습니다. 어플리케이션을 실행해 시작할 수 있습니다.
먼저 `go.mod`가 올바른지 `go mod tidy`를 실행해 모든 종속성이 존재하는지 확인합니다.

의존성이 확인되면 `make`를 실행해 바이너리를 빌드할 수 있습니다.
실제 노드 어플리케이션인 `scavengeD`와 어플리케이션과 상호작용하는 클리이언트인 `scavengeCLI` 두 개의 바이너리가 생성됩니다.

먼저 `scavengeD --help`를 실행하여 정상적으로 동작하는지 확인합니다.

```bash
Scavenge Daemon (server)

Usage:
  scavengeD [command]

Available Commands:
  init                Initialize private validator, p2p, genesis, and application configuration files
  collect-gentxs      Collect genesis txs and output a genesis.json file
  gentx               Generate a genesis tx carrying a self delegation
  validate-genesis    validates the genesis file at the default location or at the location passed as an arg
  add-genesis-account Add genesis account to genesis.json
  start               Run the full node
  unsafe-reset-all    Resets the blockchain database, removes address book files, and resets priv_validator.json to the genesis state
  tendermint          Tendermint subcommands
  export              Export state to JSON
  version             Print the app version
  help                Help about any command

Flags:
  -h, --help                    help for scavengeD
      --home string             directory for config and data (default "/home/billy/.scavengeD")
      --inv-check-period uint   Assert registered invariants every N blocks
      --log_level string        Log level (default "main:info,state:info,*:error")
      --trace                   print out full stack trace on errors

Use "scavengeD [command] --help" for more information about a command.
```

이번엔 `scavengeCLI --help` 을 실행해 다음과 같이 나오는지 확인 합니다.

```bash
Scavenge Client

Usage:
  scavengeCLI [command]

Available Commands:
  status      Query remote node for status
  config      Create or query an application CLI configuration file
  query       Querying subcommands
  tx          Transactions subcommands
  rest-server Start LCD (light-client daemon), a local REST server
  keys        Add or view local private keys
  version     Print the app version
  help        Help about any command

Flags:
      --chain-id string   Chain ID of tendermint node
  -e, --encoding string   Binary encoding (hex|b64|btc) (default "hex")
  -h, --help              help for scavengeCLI
      --home string       directory for config and data (default "/home/billy/.scavengeCLI")
  -o, --output string     Output format (text|json) (default "text")
      --trace             print out full stack trace on errors

Use "scavengeCLI [command] --help" for more information about a command.
```

이제 다른 플레이어를 위한 현상금으로 사용할 수있는 초기 코인이 있는 일부 사용자를 앱 내에 만들어야합니다.
먼저 다음 명령을 사용하여 두 명의 사용자를 만듭니다.

```bash
scavengeCLI keys add me
scavengeCLI keys add you
```

다음으로 `<moniker>` (머신의 별칭)와 어플리케이션을 식별하는 방법이 될 `<chain-id>`와 함께 Daemon 명령을 사용하여 어플리케이션을 초기화 힙니다

```bash
scavengeD init mynode --chain-id scavenge
```

이제 앞서 생성한 두 개의 계정을 다음 명령어를 통해 어플리케이션 초기 상태 즉 Genesis에 추가합니다.

```bash
scavengeD add-genesis-account $(scavengeCLI keys show me -a) 1000foo,100000000stake
scavengeD add-genesis-account $(scavengeCLI keys show you -a) 1foo
```

daemon command와 cli 명령을 포함하는 두 개의 명령을 결합했습니다. CLI command는 생성한 계정을 쿼리해 주소만 표시합니다.
**주소는 사용자 ID와 비슷합니다**
또한 일부 사용자에게 코인을 추가했음을 알 수 있습니다.
사용자 `me`를 위해 `foo`라는 토큰과 `stake`라는 토큰을 추가했습니다. Proof-Of-Stake 검증 프로세스 내에서 `stake`를 사용할 것입니다. 사용자 `me`는 `stake`를 가진 유일한 사용자 이므로 어플리케이션과 사용작용하는 유일한 **검증자**가 됩니다.
현재는 단지 학습용이기 때문에 상관 없지만, 실제 프로덕션에서는 애플리케이션을 앱이 올바르게 실행되는지 확인하기 위해 검증자를 늘릴 필요는 있습니다.

CLI 어플리케이션은 다른 어플리케이션과도 상호 작용이 가능하지만, 다음 명령을 통해 CLI 어플리케이션이 Daemon 어플리케이션 만 통신하도록 설정합니다

```bash
scavengeCLI config chain-id scavenge
scavengeCLI config output json
scavengeCLI config indent true
scavengeCLI config trust-node true
```

어플리케이션에 `me` 사용자의 정보(token 생성 등)을 알리기 위해 다음 명령을 사용해 transaction을 생성 합니다.

```bash
scavengeD gentx --name me
```

마지막으로 생성된 transaction을 genesis에 포함 시킵니다.

```bash
scavengeD collect-gentxs
```

일반적으로 이러한 과정들을 하나의 실행 파일로 작성 한다면 매번 번거롭게 수동으로 처리하지 않아도 됩니다.
또한 매번 비밀번호를 넣을 필요가 없도록 `keyring-backend`를 `test`로 사용하도록 설정할 수 도 있습니다.
이러한 과정을 다음과 같이 `./init.sh` 파일에 넣어 진행할 수 있습니다.

[init.sh](https://github.com/cosmos/sdk-tutorials/tree/master/scavenge/init.sh)

**_마지막으로_ 어플리케이션을 실행할 일만 남았습니다.**

다음과 같은 명령어를 통해 노드 daemon을 실행 시킵니다.

```bash
scavengeD start
```

이제 다음 예제를 통해 scavenge 게임을 즐겨볼 차례 입니다.
